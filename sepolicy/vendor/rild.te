type rild, domain;
type rild_exec, exec_type, file_type, vendor_file_type;

binder_service(rild)

hal_client_domain(rild, vendor_hal_imsfactory)

hal_server_domain(rild, hal_secure_element)
hal_server_domain(rild, hal_telephony)
hal_server_domain(rild, vendor_hal_dataconnection_qti)
hal_server_domain(rild, vendor_hal_iwlanservice_qti)

net_domain(rild)

binder_call(rild, hal_graphics_composer_default)
binder_call(rild, vendor_hal_display_config_hwservice)
binder_call(rild, vendor_per_mgr)

crash_dump_fallback(rild)

get_prop(rild, audio_config_prop)
get_prop(rild, radio_control_prop)
get_prop(rild, vendor_cpuid_prop)
get_prop(rild, vendor_dataqdp_prop)
get_prop(rild, vendor_miui_region_prop)
get_prop(rild, vendor_miui_singlesim_prop)
get_prop(rild, vendor_qc_aon_prop)

init_daemon_domain(rild)

r_dir_file(rild, vendor_mbn_data_file)

set_prop(rild, vendor_btmac_prop)
set_prop(rild, vendor_deviceid_prop)
set_prop(rild, vendor_factoryid_prop)
set_prop(rild, vendor_radio_prop)
set_prop(rild, vendor_sno_prop)
set_prop(rild, vendor_ssr_prop)
set_prop(rild, vendor_system_prop)
set_prop(rild, vendor_usb_prop)
set_prop(rild, vendor_wlanchip_prop)
set_prop(rild, vendor_xlat_prop)

unix_socket_connect(rild, property, tombstoned)
unix_socket_connect(rild, property, vendor_ssgtzd)
unix_socket_connect(rild, property, vendor_time_daemon)
unix_socket_connect(rild, tombstoned_crash, init)
unix_socket_connect(rild, vendor_ssgtzd, init)

vndbinder_use(rild)

allow rild block_device:dir { open read search write };
allow rild block_device:file { open read write };
allow rild media_rw_data_file:file { getattr read write };
allow rild mnt_user_file:dir create_dir_perms;
allow rild mnt_user_file:file create_file_perms;
allow rild mnt_user_file:lnk_file read;
allow rild sdcardfs:dir create_dir_perms;
allow rild sdcardfs:file create_file_perms;
allow rild self:socket ioctl;
allow rild self:{ qipcrtr_socket tipc_socket } create_socket_perms_no_ioctl;
allow rild storage_file:dir create_dir_perms;
allow rild storage_file:file create_file_perms;
allow rild storage_file:lnk_file { read write };
allow rild sysfs:file getattr;
allow rild sysfs:file write;
allow rild sysfs:{ dir file } open;
allow rild sysfs:{ dir file } read;
allow rild system_data_file:file { getattr ioctl read };
allow rild system_data_file:file read;
allow rild vendor_diag_device:chr_file rw_file_perms;
allow rild vendor_file:file { execute_no_trans ioctl lock };
allow rild vendor_hal_display_config_hwservice:hwservice_manager find;
allow rild vendor_mac_addr_file:dir { add_name search write };
allow rild vendor_mac_addr_file:file { create getattr open read write };
allow rild vendor_mbn_data_file:dir create_dir_perms;
allow rild vendor_mbn_data_file:file create_file_perms;
allow rild vendor_modem_data_file:dir create_dir_perms;
allow rild vendor_modem_data_file:file create_file_perms;
allow rild vendor_per_mgr_service:service_manager find;
allow rild vendor_qdisplay_service:service_manager find;
allow rild vendor_qmuxd_socket:dir w_dir_perms;
allow rild vendor_qmuxd_socket:sock_file create_file_perms;
allow rild vendor_radio_smd_device:{ chr_file file } { open read write };
allow rild vendor_radio_vendor_data_file:dir create_dir_perms;
allow rild vendor_radio_vendor_data_file:dir rw_dir_perms;
allow rild vendor_radio_vendor_data_file:file create_file_perms;
allow rild vendor_ramdump_vendor_data_file:dir rw_dir_perms;
allow rild vendor_ramdump_vendor_data_file:fifo_file { create getattr open read unlink write };
allow rild vendor_ramdump_vendor_data_file:file { create getattr open read setattr unlink write };
allow rild vendor_rild_socket:dir w_dir_perms;
allow rild vendor_rild_socket:sock_file create_file_perms;
allow rild vendor_shm_chr_device:chr_file r_file_perms;
allow rild vendor_sysfs_ssr_toggle:file rw_file_perms;
allow rild vendor_tombstone_data_file:dir create_dir_perms;
allow rild vendor_tombstone_data_file:file create_file_perms;
allow rild vendor_toolbox_exec:file execute_no_trans;

allowxperm rild self:socket ioctl { 0xc300 0xc301 0xc302 0xc303 0xc304 0xc305 };
